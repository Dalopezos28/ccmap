{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard - Minimal SaaS{% endblock %}

{% block extra_css %}
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Dashboard Styles -->
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- Navegación -->
    <a href="{% url 'mapa' %}" class="nav-back">
        <i class="fas fa-arrow-left"></i>
        <span>Volver al Mapa</span>
    </a>

    <!-- Header -->
    <div class="dashboard-header">
        <h1>Dashboard de Estadísticas</h1>
        <p>Visualización del impacto social de los comedores comunitarios.</p>
    </div>

    <!-- Métricas Destacadas -->
    <div class="metrics-grid">
        <!-- Card 1: Comidas Servidas -->
        <div class="metric-card info">
            <div class="card-header">
                <span class="card-title">Comidas Servidas (Mes)</span>
                <div class="card-icon"><i class="fas fa-utensils"></i></div>
            </div>
            <div class="metric-value" id="metric-comidas">...</div>
            <div class="metric-footer">
                <span class="badge success"><i class="fas fa-arrow-up"></i> 5.2%</span>
                <span class="time">vs. el mes pasado</span>
            </div>
        </div>

        <!-- Card 2: Donaciones Recibidas -->
        <div class="metric-card success">
            <div class="card-header">
                <span class="card-title">Donaciones Recibidas</span>
                <div class="card-icon"><i class="fas fa-hand-holding-heart"></i></div>
            </div>
            <div class="metric-value" id="metric-donaciones">...</div>
            <div class="metric-footer">
                <span class="time">Actualizado ahora</span>
            </div>
        </div>

        <!-- Card 3: Personas Atendidas -->
        <div class="metric-card warning">
            <div class="card-header">
                <span class="card-title">Personas Atendidas (Hoy)</span>
                <div class="card-icon"><i class="fas fa-users"></i></div>
            </div>
            <div class="metric-value" id="metric-personas">...</div>
            <div class="metric-footer">
                <span class="badge success"><i class="fas fa-arrow-up"></i> 10</span>
                <span class="time">en la última hora</span>
            </div>
        </div>

        <!-- Card 4: Valor Donaciones -->
        <div class="metric-card danger">
            <div class="card-header">
                <span class="card-title">Valor Donaciones (COP)</span>
                <div class="card-icon"><i class="fas fa-dollar-sign"></i></div>
            </div>
            <div class="metric-value" id="metric-valor">...</div>
            <div class="metric-footer">
                <span class="time">Total acumulado</span>
            </div>
        </div>
    </div>

    <!-- Gráficos -->
    <div class="charts-grid">
        <!-- Gráfico 1: Evolución de Métricas -->
        <div class="chart-card full-width">
            <h3>Evolución de Métricas (Últimos 7 Días)</h3>
            <div class="chart-container tall">
                <canvas id="chart-evolucion"></canvas>
            </div>
        </div>

        <!-- Gráfico 2: Top Comedores -->
        <div class="chart-card">
            <h3>Top 10 Comedores (Mes)</h3>
            <div class="chart-container tall">
                <canvas id="chart-comedores"></canvas>
            </div>
        </div>

        <!-- Gráfico 3: Donaciones por Tipo -->
        <div class="chart-card">
            <h3>Donaciones por Tipo</h3>
            <div class="chart-container">
                <canvas id="chart-donaciones"></canvas>
            </div>
        </div>
    </div>

    <!-- Mensaje de error (oculto por defecto) -->
    <div id="error-message" class="error" style="display: none;">
        <i class="fas fa-exclamation-triangle"></i>
        <span id="error-text"></span>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>

<!-- Dashboard Script -->
<script src="{% static 'js/dashboard.js' %}"></script>
{% endblock %}